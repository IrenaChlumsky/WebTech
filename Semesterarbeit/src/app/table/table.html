<div class="table-shell container py-3">
   <div class="table-card">
  <h2 class="mb-3">Pokémon-Liste</h2>

  @if (!loading && !error) {
    <div class="filterbar">
      <div class="filters">
        <label>
          <span>filtern nach Name</span>
          <input
            type="text"
            class="form-control"
            aria-label="Pokémon-Name"
            #nameInput
            placeholder="z. B. Pika…"
            (input)="filterPokemon(nameInput.value, typeInput.value)"
          />
        </label>

        <label>
          <span>filtern nach Typ</span>
          <input
            type="text"
            class="form-control"
            aria-label="Pokémon-Typ"
            #typeInput
            placeholder="z. B. Feuer / Elektro"
            (input)="filterPokemon(nameInput.value, typeInput.value)"
          />
        </label>
      </div>

      <div class="actions">
        <button class="btn btn-outline-secondary"
                (click)="resetFilter(nameInput, typeInput)">
          Zurücksetzen
        </button>

      @if (view) {
  <span class="count">
    {{ view.length }} / {{ pokemons.length }} Einträge
  </span>
      }
       </div> 
  </div>
  }

  @if (!loading && !error) {
    <div class="table-responsive">
      <table class="table table-striped table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th style="width:4ch;">#</th>
            <th>Name</th>
            <th>Haupttyp</th>
            <th>Zweittyp</th>
            <th style="width:8ch;">Level</th>
            <th>Attacken</th>
            <th class="text-end" style="width:10rem;">Aktionen</th>
          </tr>
        </thead>
        <tbody>
          @for (p of view; track p._id ?? $index; let i = $index) {
            <tr>
              <td>{{ i + 1 }}</td>
              <td>{{ p.name }}</td>
              <td>{{ p.type1 }}</td>
              <td>{{ p.type2 ?? '—' }}</td>
              <td>{{ p.level }}</td>
              <td>{{ p.attacks.join(' · ') }}</td>
              <td class="text-end">
                <div class="btn-group btn-group-sm" role="group" aria-label="Aktionen">
                  <button type="button" class="btn btn-outline-danger"
                          title="Löschen" aria-label="Löschen"
                          (click)="onRemove(p._id!)">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
          } @empty {
            <tr>
              <td colspan="7" class="text-center text-muted">Noch keine Einträge.</td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>
</div> 

<div class="toast-container position-fixed top-50 start-50 translate-middle p-3">
  <div #deleteToastEl class="toast shadow-lg" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="toast-header bg-warning text-dark">
      <strong class="me-auto">Löschen bestätigen</strong>
      <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"
              (click)="onConfirmDelete(false)"></button>
    </div>
    <div class="toast-body">
      <p class="mb-2">Soll „{{ pendingDeleteName }}“ wirklich gelöscht werden?</p>
      <div class="d-flex justify-content-end gap-2 pt-2 border-top">
        <button class="btn btn-secondary btn-sm" (click)="onConfirmDelete(false)">Abbrechen</button>
        <button class="btn btn-danger btn-sm" (click)="onConfirmDelete(true)">Ja, löschen</button>
      </div>
    </div>
  </div>
</div>
